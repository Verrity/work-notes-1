
---
### Теги

### Назад
#### [[WLC]]
### Далее
####
---

Ipc реализовано библиотекой `zmq`.
Объект класса`IpcPort` имеет `zmq` сокеты:
- `pubisher/subscriber` - используется для общения между компонентами
- `router` - используется для общения между компонентом и его воркерами (класс `IpcPortWorker`)
Объект класса`IpcPortWorker` имеет `zmq` сокеты `router/dealer` для обмена между компонентом и и воркером.

Сокеты биндятся на свои адреса в файле `src/ipc/config.cpp` посредством  механизма`ipc`.

Хотя я считаю, что лучше было организовать работу воркеров так:
Есть процесс - слушатель, у него есть сокеты `sub`, `push`. Через `sub` он получает сообщения других компонентов, а через `push` передает в поток - воркер.  У воркера есть сокеты `sub`, `pull`.  Вернее, сокеты есть у процесса слушателя (но если каждый поток использует свой сокет, то сериализация им не нужна, они асинхронны). Через `pull` воркер получает сообщения, а через `sub` отдает.  Тут есть 2 преимущества: `push/[N]pull` обмениваются механизмом `inproc`, а не `ipc`, что намного быстрее, также push автоматически циклически распределяет сообщения между `pull` сокетами. Минус в том, что придется биндить каждый `pub` сокет, поэтому количество воркеров жестко ограничено.